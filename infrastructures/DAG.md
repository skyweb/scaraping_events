## Esecuzione manuale tramite Airflow CLI                                                                                                                                                                                                                                                                                                                                                                 
                                  
```bash                                                                                                                                                                                                                                                                                                                                                                          
# Entra nel container Airflow                                                                                                                                                                                                                                                                                                                                                                             
$ docker exec -it airflow-webserver bash                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                            
# Testa il DAG per errori di sintassi                                                                                                                                                                                                                                                                                                                                                                     
$ airflow dags test etl_events_daily 2026-01-28                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                            
# Esegui un singolo task                                                                                                                                                                                                                                                                                                                                                                                  
$ airflow tasks test etl_events_daily truncate_staging 2026-01-28                                                                                                                                                                                                                                                                                                                                           
$ airflow tasks test etl_events_daily load_to_staging 2026-01-28                                                                                                                                                                                                                                                                                                                                            
```

## Esecuzione con filtro citt√† (un solo task)                                                                                                                                                                                                                                                                                                                                                             
```bash
# Oppure via CLI:                                                                                                                                                                                                                                                                                                                                                                                         
$ airflow dags trigger etl_events_daily --conf '{"city": "milano"}'                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                            
# Oppure filtra per source specifico:                                                                                                                                                                                                                                                                                                                                                                     
$ airflow dags trigger etl_events_daily --conf '{"cities_today": "milano,roma"}'                                                                                                                                                                                                                                                                                                                            
$ airflow dags trigger etl_events_daily --conf '{"cities_zero": "milano"}'                                                                                                                                                                                                                                                                                                                                  
``` 

                                                                                                                                                                                                                                                                                                                                                                                                            
```bash                                                                                                                                                                                                                                                                                                                                                                                                            
# Log del DAG processor                                                                                                                                                                                                                                                                                                                                                                                   
$ tail -f /Users/skyweb/Sites/today_events/infrastructures/logs/dag_processor_manager/dag_processor_manager.log                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                                          
# Log dei task (dalla directory logs di Airflow)                                                                                                                                                                                                                                                                                                                                                          
$ ls /Users/skyweb/Sites/today_events/infrastructures/logs/                                                                                                                                                                                                                                                                                                                                                 
 
```

## testare le funzioni ETL direttamente:        

```python                                                                                                                                                                                                                                                                                                                                                                                                            
# Test load_json_to_staging                                                                                                                                                                                                                                                                                                                                                                               
from dags.scrape_events import load_json_to_staging                                                                                                                                                                                                                                                                                                                                                       
```

```bash
# Esegui solo Milano                                                                                                                                                                                                                                                                                                                                                                                      
$ docker exec -it events-airflow-webserver airflow dags trigger etl_events_daily --conf '{"city": "milano"}'                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                        
# Test di un singolo task (senza salvare nel DB)                                                                                                                                                                                                                                                                                                                                                          
$ docker exec -it events-airflow-webserver airflow tasks test etl_events_daily truncate_staging 2026-01-2
```

Per eseguire solo il task scrape_zero_eu di Milano:                                                                                                                                                                                                                                                                                                                                                       
       
```bash                                                                                                                                                                                                                                                                                                                                                                                                     
# Test singolo task (non salva nel DB, utile per debug)                                                                                                                                                                                                                                                                                                                                                   
$ docker exec events-airflow-webserver airflow tasks test etl_events_daily process_milano.scrape_zero_eu 2026-01-28                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                   
# Oppure run (salva nel DB)                                                                                                                                                                                                                                                                                                                                                                               
$ docker exec events-airflow-webserver airflow tasks run etl_events_daily process_milano.scrape_zero_eu 2026-01-28                                                                                                                                                                                                                                                                                          
```                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                            
Se invece vuoi triggerare il DAG completo ma eseguire solo zero_eu per milano, usa la config:
      
```bash                                                                                                                                                                                                                                                                                                                                                                                                      
$ docker exec events-airflow-webserver airflow dags trigger etl_events_daily --conf '{"city": "milano", "cities_today": []}'                                                                                                                                                                                                                                                                                
```